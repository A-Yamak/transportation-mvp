# ==============================================================================
# Al-Sabiqoon - Production Secrets Template
# ==============================================================================
#
# IMPORTANT: NEVER commit actual secrets to version control!
#
# This is a TEMPLATE file. To use it:
#   1. Copy to secrets.yaml (which is gitignored)
#   2. Replace placeholder values with real secrets
#   3. Apply with: kubectl apply -f secrets.yaml -n alsabiqoon
#
# For production, use one of these secure approaches:
#
# Option 1: Sealed Secrets (Recommended for GitOps)
# ------------------------------------------------
#   kubeseal --format yaml < secrets.yaml > sealed-secrets.yaml
#   Then commit sealed-secrets.yaml (encrypted, safe to commit)
#
# Option 2: External Secrets Operator
# -----------------------------------
#   Store secrets in AWS Secrets Manager, HashiCorp Vault, or similar
#   External Secrets Operator syncs them to Kubernetes Secrets
#
# Option 3: Kubernetes Secrets with RBAC
# --------------------------------------
#   Apply secrets directly and use RBAC to restrict access
#   kubectl apply -f secrets.yaml -n alsabiqoon
#
# ==============================================================================
#
# Laravel Config Caching Note:
# ----------------------------
# After config:cache runs, .env is NOT read. These secrets are passed via
# Kubernetes environment variables, which Laravel's config() reads at boot.
#
# Make sure your config/*.php files map these env vars:
#   config('app.key')       <- uses env('APP_KEY')
#   config('database.password') <- uses env('DB_PASSWORD')
#
# ==============================================================================

apiVersion: v1
kind: Secret
metadata:
  name: backend-secrets
  labels:
    app: alsabiqoon
    component: backend
type: Opaque
stringData:
  # -----------------------------------------------------------------------------
  # Application Secrets
  # -----------------------------------------------------------------------------
  # APP_KEY: Generate with `php artisan key:generate --show`
  # Must be exactly 32 characters for AES-256 encryption
  APP_KEY: "base64:REPLACE_WITH_32_CHAR_KEY_HERE"

  # -----------------------------------------------------------------------------
  # Database Secrets
  # -----------------------------------------------------------------------------
  # Production database credentials
  # Consider using a managed database service (AWS RDS, Google Cloud SQL, etc.)
  DB_USERNAME: "alsabiqoon_prod"
  DB_PASSWORD: "REPLACE_WITH_STRONG_PASSWORD"

  # -----------------------------------------------------------------------------
  # Redis Secrets (if AUTH is enabled)
  # -----------------------------------------------------------------------------
  # Leave empty if Redis doesn't require authentication
  REDIS_PASSWORD: ""

  # -----------------------------------------------------------------------------
  # OAuth2 / Passport Secrets
  # -----------------------------------------------------------------------------
  # Generate with: php artisan passport:keys
  # Then base64 encode: cat storage/oauth-private.key | base64 -w0
  #
  # These allow stateless API authentication without storing keys on disk
  PASSPORT_PRIVATE_KEY: |
    -----BEGIN RSA PRIVATE KEY-----
    REPLACE_WITH_YOUR_PRIVATE_KEY
    -----END RSA PRIVATE KEY-----
  PASSPORT_PUBLIC_KEY: |
    -----BEGIN PUBLIC KEY-----
    REPLACE_WITH_YOUR_PUBLIC_KEY
    -----END PUBLIC KEY-----

  # -----------------------------------------------------------------------------
  # Mail Secrets
  # -----------------------------------------------------------------------------
  # SMTP credentials for transactional email
  # Consider using a service like Mailgun, SendGrid, or AWS SES
  MAIL_HOST: "smtp.mailgun.org"
  MAIL_PORT: "587"
  MAIL_USERNAME: "REPLACE_WITH_MAIL_USERNAME"
  MAIL_PASSWORD: "REPLACE_WITH_MAIL_PASSWORD"
  MAIL_ENCRYPTION: "tls"

  # -----------------------------------------------------------------------------
  # Cloudflare R2 Secrets
  # -----------------------------------------------------------------------------
  # R2 uses S3-compatible API with Cloudflare-specific endpoint
  CLOUDFLARE_R2_ACCESS_KEY_ID: "REPLACE_WITH_R2_ACCESS_KEY"
  CLOUDFLARE_R2_SECRET_ACCESS_KEY: "REPLACE_WITH_R2_SECRET_KEY"
  CLOUDFLARE_R2_ENDPOINT: "https://ACCOUNT_ID.r2.cloudflarestorage.com"
  CLOUDFLARE_R2_URL: "https://assets.alsabiqoon.com"

  # -----------------------------------------------------------------------------
  # External API Secrets (Add as needed)
  # -----------------------------------------------------------------------------
  # STRIPE_SECRET_KEY: "sk_live_..."
  # PUSHER_APP_KEY: "..."
  # PUSHER_APP_SECRET: "..."

# ==============================================================================
# ConfigMap vs Secret Decision Guide:
# ==============================================================================
#
# Use ConfigMap for:
#   - APP_ENV, APP_DEBUG, APP_URL
#   - LOG_LEVEL, LOG_CHANNEL
#   - Cache/queue driver names (redis, database)
#   - Service hostnames (mysql-service, redis-service)
#   - Feature flags
#   - Non-sensitive URLs
#
# Use Secrets for:
#   - APP_KEY (encryption key)
#   - Database passwords
#   - API keys and tokens
#   - OAuth credentials
#   - Private keys (Passport, JWT)
#   - SMTP passwords
#   - Third-party service credentials
#
# Rule of thumb: If exposing it would be a security issue, use a Secret.
#
# ==============================================================================
